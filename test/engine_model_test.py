from definitions import from_root
from engines.metastore.models import schemas
from test.support.testing_base import set_log_level
import unittest


# class TestEngineModel():
class EngineModelTest(unittest.TestCase):

    def test_file_model(self):
        set_log_level("trace")

        header = b'PAR1\x15\x04\x15<\x15<L\x15\x02\x15\x04\x12\x00\x00\x1a\x00\x00\x00logistics.bi.datapublisher\x15\x00\x15\x12\x15\x12,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x1alogistics.bi.datapublisher\x18\x1alogistics.bi.datapublisher\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x01\x1c\x00&\x8c\x02\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x05AppId\x15\x00\x16\x1c\x16\x84\x02\x16\x84\x02&`&\x08\x1c6\x00(\x1alogistics.bi.datapublisher\x18\x1alogistics.bi.datapublisher\x00\x00\x00\x15\x04\x15\x18\x15\x18L\x15\x02\x15\x04\x12\x00\x00\x08\x00\x00\x00shipment\x15\x00\x15\x12\x15\x12,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x08shipment\x18\x08shipment\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x01\x1c\x00&\xe2\x04\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\nCollection\x15\x00\x16\x1c\x16\x98\x01\x16\x98\x01&\xfe\x03&\xca\x03\x1c6\x00(\x08shipment\x18\x08shipment\x00\x00\x00\x15\x04\x15\xfe\x06\x15\xfe\x06L\x15\x1c\x15\x04\x12\x00\x00\x1c\x00\x00\x002020-02-19T23:29:00.1716834Z\x1c\x00\x00\x002020-02-19T23:39:41.3031192Z\x1c\x00\x00\x002020-02-19T23:18:19.6652208Z\x1b\x00\x00\x002020-02-19T23:18:19.803623Z\x1c\x00\x00\x002020-02-19T23:01:20.2047236Z\x1c\x00\x00\x002020-02-19T22:30:53.9305028Z\x1c\x00\x00\x002020-02-19T22:30:53.7676558Z\x1c\x00\x00\x002020-02-19T22:30:57.7062105Z\x1c\x00\x00\x002020-02-19T23:18:19.5523041Z\x1c\x00\x00\x002020-02-19T22:30:49.9810338Z\x1c\x00\x00\x002020-02-19T23:18:19.4417606Z\x1c\x00\x00\x002020-02-19T22:30:46.3546169Z\x1c\x00\x00\x002020-02-19T23:18:19.1635596Z\x1c\x00\x00\x002020-02-19T22:09:08.1076122Z\x15\x00\x15 \x15 ,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x1c2020-02-19T23:39:41.3031192Z\x18\x1c2020-02-19T22:09:08.1076122Z\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x04\x05\x102Tv\x98\xba\xdc\x00&\xc6\x0e\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x12TransactionTimeUtc\x15\x00\x16\x1c\x16\xe0\x08\x16\xe0\x08&\x84\r&\xe6\x05\x1c6\x00(\x1c2020-02-19T23:39:41.3031192Z\x18\x1c2020-02-19T22:09:08.1076122Z\x00\x00\x00\x15\x04\x15\x14\x15\x14L\x15\x02\x15\x04\x12\x00\x00\x06\x00\x00\x00update\x15\x00\x15\x12\x15\x12,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x06update\x18\x06update\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x01\x1c\x00&\xb6\x11\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\tOperation\x15\x00\x16\x1c\x16\x8c\x01\x16\x8c\x01&\xda\x10&\xaa\x10\x1c6\x00(\x06update\x18\x06update\x00\x00\x00\x15\x04\x15\x08\x15\x08L\x15\x02\x15\x04\x12\x00\x00\x01\x00\x00\x00\x15\x00\x15\x12\x15\x12,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c\x18\x04\x01\x00\x00\x00\x18\x04\x01\x00\x00\x00\x16\x00(\x04\x01\x00\x00\x00\x18\x04\x01\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x01\x1c\x00&\xc0\x13\x1c\x15\x02\x195\x04\x00\x06\x19\x18\x0cModelVersion\x15\x00\x16\x1c\x16\x90\x01\x16\x90\x01&\xd4\x12&\xb0\x12\x1c\x18\x04\x01\x00\x00\x00\x18\x04\x01\x00\x00\x00\x16\x00(\x04\x01\x00\x00\x00\x18\x04\x01\x00\x00\x00\x00\x00\x00\x15\x04\x15p\x15pL\x15\x1c\x15\x04\x12\x00\x00\xcf\xc7\xa8\x00\xce\xc7\xa8\x00\xcd\xc7\xa8\x00\xcc\xc7\xa8\x00\xc9\xc7\xa8\x00\xf3\xc6\xa8\x00\xf2\xc6\xa8\x00\xeb\xc6\xa8\x00\x98\xc5\xa8\x00o\xc5\xa8\x00n\xc5\xa8\x00m\xc5\xa8\x00j\xc5\xa8\x00T\xbf\xa8\x00\x15\x00\x15 \x15 ,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c\x18\x04\xcf\xc7\xa8\x00\x18\x04T\xbf\xa8\x00\x16\x00(\x04\xcf\xc7\xa8\x00\x18\x04T\xbf\xa8\x00\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x04\x05\x102Tv\x98\xba\xdc\x00&\xd6\x16\x1c\x15\x02\x195\x04\x00\x06\x19\x18\nShipmentId\x15\x00\x16\x1c\x16\x86\x02\x16\x86\x02&\xdc\x15&\xd0\x14\x1c\x18\x04\xcf\xc7\xa8\x00\x18\x04T\xbf\xa8\x00\x16\x00(\x04\xcf\xc7\xa8\x00\x18\x04T\xbf\xa8\x00\x00\x00\x00\x15\x04\x15\xec\x02\x15\xec\x02L\x15\x1c\x15\x04\x12\x00\x00\t\x00\x00\x00B11061199\t\x00\x00\x00B11061198\t\x00\x00\x00B11061197\t\x00\x00\x00B11061196\t\x00\x00\x00B11061193\t\x00\x00\x00B11060979\t\x00\x00\x00B11060978\t\x00\x00\x00B11060971\t\x00\x00\x00B11060632\t\x00\x00\x00B11060591\t\x00\x00\x00B11060590\t\x00\x00\x00B11060589\t\x00\x00\x00B11060586\t\x00\x00\x00B11059028\x15\x00\x15 \x15 ,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\tB11061199\x18\tB11059028\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x04\x05\x102Tv\x98\xba\xdc\x00&\xe4\x1b\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x11ShipmentReference\x15\x00\x16\x1c\x16\x82\x04\x16\x82\x04&\xee\x1a&\xe2\x17\x1c6\x00(\tB11061199\x18\tB11059028\x00\x00\x00\x15\x04\x15H\x15HL\x15\x12\x15\x04\x12\x00\x00\xbeB\x01\x00\xaa;\x00\x00S\x00\x00\x00\xcc\xae\x01\x00\xc3\xc4\x00\x00\x15\x04\x00\x00z\x95\x00\x008\xb7\x00\x00\xce&\x01\x00\x15\x00\x15 \x15 ,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c\x18\x04\xcc\xae\x01\x00\x18\x04S\x00\x00\x00\x16\x00(\x04\xcc\xae\x01\x00\x18\x04S\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x04\x05\x10"CDRb\x87\x00&\xd8\x1e\x1c\x15\x02\x195\x04\x00\x06\x19\x18\nCustomerId\x15\x00\x16\x1c\x16\xde\x01\x16\xde\x01&\xde\x1d&\xfa\x1c\x1c\x18\x04\xcc\xae\x01\x00\x18\x04S\x00\x00\x00\x16\x00(\x04\xcc\xae\x01\x00\x18\x04S\x00\x00\x00\x00\x00\x00\x15\x04\x15\x96\x01\x15\x96\x01L\x15\x10\x15\x04\x12\x00\x00\x04\x00\x00\x00UPS1\x03\x00\x00\x00DHL\x03\x00\x00\x00UPS\x06\x00\x00\x00UPSSAT\x06\x00\x00\x00FEDSOS\x06\x00\x00\x00WILCAL\x06\x00\x00\x00UPSEXP\t\x00\x00\x00UPSWWSAVE\x15\x00\x15\x1c\x15\x1c,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x06WILCAL\x18\x03DHL\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x03\x05\x880\xb2\x88\xfc\x00&\xfa!\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x0fFreight_ShipVia\x15\x00\x16\x1c\x16\x96\x02\x16\x96\x02&\x9a!&\xe4\x1f\x1c6\x00(\x06WILCAL\x18\x03DHL\x00\x00\x00\x15\x04\x15H\x15HL\x15\x08\x15\x04\x12\x00\x00\x03\x00\x00\x00UPS\x03\x00\x00\x00DHL\x05\x00\x00\x00FedEx\t\x00\x00\x00WILL CALL\x15\x00\x15\x18\x15\x18,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\tWILL CALL\x18\x03DHL\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x02\x05\x04\xe8\x04\x04&\xc0$\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x0fFreight_Carrier\x15\x00\x16\x1c\x16\xc6\x01\x16\xc6\x01&\xde#&\xfa"\x1c6\x00(\tWILL CALL\x18\x03DHL\x00\x00\x00\x15\x04\x15\xde\x01\x15\xde\x01L\x15\x0c\x15\x04\x12\x00\x00\x0c\x00\x00\x00Next Day Air\x1a\x00\x00\x00Worldwide Priority Express\x12\x00\x00\x00Standard Overnight\t\x00\x00\x00WILL CALL\x07\x00\x00\x00Express\x0f\x00\x00\x00Worldwide Saver\x15\x00\x15\x1c\x15\x1c,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x0fWorldwide Saver\x18\x07Express\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x03\x05\x08\x00i\x08\xd8\x00&\xbe(\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x14Freight_ServiceLevel\x15\x00\x16\x1c\x16\xf8\x02\x16\xf8\x02&\xc4\'&\xc6%\x1c6\x00(\x0fWorldwide Saver\x18\x07Express\x00\x00\x00\x15\x04\x15\x10\x15\x10L\x15\x04\x15\x04\x12\x00\x00(\x00\x00\x00\x1e\x00\x00\x00\x15\x00\x15\x14\x15\x14,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c\x18\x04(\x00\x00\x00\x18\x04\x1e\x00\x00\x00\x16\x00(\x04(\x00\x00\x00\x18\x04\x1e\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x01\x05\x84\x04&\xfc*\x1c\x15\x02\x195\x04\x00\x06\x19\x18\x15Freight_TransportMode\x15\x00\x16\x1c\x16\x9a\x01\x16\x9a\x01&\x8e*&\xe2)\x1c\x18\x04(\x00\x00\x00\x18\x04\x1e\x00\x00\x00\x16\x00(\x04(\x00\x00\x00\x18\x04\x1e\x00\x00\x00\x00\x00\x00\x15\x04\x15\x10\x15\x10L\x15\x02\x15\x04\x12\x00\x00\x00\x00\x00\x00\x00\x00\xf0?\x15\x00\x15\x12\x15\x12,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c\x18\x08\x00\x00\x00\x00\x00\x00\xf0?\x18\x08\x00\x00\x00\x00\x00\x00\xf0?\x16\x00(\x08\x00\x00\x00\x00\x00\x00\xf0?\x18\x08\x00\x00\x00\x00\x00\x00\xf0?\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x01\x1c\x00&\xd6-\x1c\x15\n\x195\x04\x00\x06\x19\x18\x15Freight_FreightCharge\x15\x00\x16\x1c\x16\xb8\x01\x16\xb8\x01&\xca,&\x9e,\x1c\x18\x08\x00\x00\x00\x00\x00\x00\xf0?\x18\x08\x00\x00\x00\x00\x00\x00\xf0?\x16\x00(\x08\x00\x00\x00\x00\x00\x00\xf0?\x18\x08\x00\x00\x00\x00\x00\x00\xf0?\x00\x00\x00\x15\x04\x15\x18\x15\x18L\x15\x04\x15\x04\x12\x00\x00\x02\x00\x00\x00IC\x02\x00\x00\x00RR\x15\x00\x15\x14\x15\x14,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x02RR\x18\x02IC\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x01\x05\xf0\n&\x9a0\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x0cShipmentType\x15\x00\x16\x1c\x16\x82\x01\x16\x82\x01&\xcc/&\x98/\x1c6\x00(\x02RR\x18\x02IC\x00\x00\x00\x15\x00\x15\x10\x15\x10,\x15\x1c\x15\x00\x15\x06\x15\x06\x1c\x18\x01\x00\x18\x01\x00\x16\x00(\x01\x00\x18\x01\x00\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x00\x00&\xdc1\x1c\x15\x00\x19%\x00\x06\x19\x18\x12IsFreightForwarded\x15\x00\x16\x1c\x16R\x16R&\x8a1<\x18\x01\x00\x18\x01\x00\x16\x00(\x01\x00\x18\x01\x00\x00\x00\x00\x15\x04\x15\xf4\x03\x15\xf4\x03L\x15\x1a\x15\x04\x12\x00\x00\x12\x00\x00\x001ZY1E4820100001094\n\x00\x00\x002466120064\x12\x00\x00\x001Z6E265F0300009773\x12\x00\x00\x001Z6E265F0100009768\x12\x00\x00\x001Z6R36A64400005984\x0c\x00\x00\x00106475708787\x0c\x00\x00\x00106475708776\x12\x00\x00\x001Z6E265F0100009759\n\x00\x00\x004298460106\x12\x00\x00\x001Z6E265F0300009737\x12\x00\x00\x001Z6R36A66600005979\x12\x00\x00\x001Z6E265F0400009717\n\x00\x00\x005532085204\x15\x00\x15"\x15",\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x02(\n5532085204\x18\x0c106475708776\x00\x00\x00\x03\x00\x00\x00\x05\x7f?\x04\x05\x102Tv\x98\xba\x0c\x00&\xe87\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x12LeadTrackingNumber\x15\x00\x16\x1c\x16\x94\x05\x16\x94\x05&\xe86&\xd42\x1c6\x02(\n5532085204\x18\x0c106475708776\x00\x00\x00\x15\x04\x150\x150L\x15\x08\x15\x04\x12\x00\x00\x02\x00\x00\x00OG\x02\x00\x00\x00HZ\x02\x00\x00\x00WV\x02\x00\x00\x00MG\x15\x00\x15\x18\x15\x18,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x02WV\x18\x02HZ\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x02\x05\xa4\xff\xee\x06&\xa6:\x1c\x15\x0c\x195\x04\x00\x06\x19\x18\x15ShipFromFacility_Code\x15\x00\x16\x1c\x16\x9e\x01\x16\x9e\x01&\xd49&\x889\x1c6\x00(\x02WV\x18\x02HZ\x00\x00\x00\x15\x04\x15>\x15>L\x15\x08\x15\x04\x12\x00\x00\x03\x00\x00\x00SOG\x04\x00\x00\x00HZUT\x05\x00\x00\x00WVLLE\x03\x00\x00\x00SME\x15\x00\x15\x18\x15\x18,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c6\x00(\x05WVLLE\x18\x04HZUT\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x02\x05\xa4\xff\xee\x06&\xde<\x1c\x15\x0c\x195\x04\x00\x06\x19\x18 ShipFromFacility_PackingLocation\x15\x00\x16\x1c\x16\xb6\x01\x16\xb6\x01&\x82<&\xa8;\x1c6\x00(\x05WVLLE\x18\x04HZUT\x00\x00\x00\x15\x04\x15H\x15HL\x15\x12\x15\x04\x12\x00\x00$\t\x05\x00W\x93\x01\x00L\x00\x00\x00\x9b\xc9\x04\x00K\xf4\x04\x00\\F\x02\x00\xa1\xe9\x01\x00\x06\x0b\x05\x001\xdb\x00\x00\x15\x00\x15 \x15 ,\x15\x1c\x15\x04\x15\x06\x15\x06\x1c\x18\x04\x06\x0b\x05\x00\x18\x04L\x00\x00\x00\x16\x00(\x04\x06\x0b\x05\x00\x18\x04L\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x1c\x01\x04\x05\x10"CEbr\x18\x00&\xde?\x1c\x15\x02\x195\x04\x00\x06\x19\x18\x11Ship'
        with open(from_root("/test/test_footer.parquet"), "rb") as footer:
            footer_bytes = footer.read()
            s = schemas.from_header_and_footer(header, footer_bytes)
            expect = '- schema: REQUIRED' '| - AppId: BYTE_ARRAY, UTF8, OPTIONAL' '| - Collection: BYTE_ARRAY, UTF8, OPTIONAL' '| - TransactionTimeUtc: BYTE_ARRAY, UTF8, OPTIONAL' '| - Operation: BYTE_ARRAY, UTF8, OPTIONAL' '| - ModelVersion: INT32, OPTIONAL' '| - ShipmentId: INT32, OPTIONAL' '| - ShipmentReference: BYTE_ARRAY, UTF8, OPTIONAL' '| - CustomerId: INT32, OPTIONAL' '| - Freight_ShipVia: BYTE_ARRAY, UTF8, OPTIONAL' '| - Freight_Carrier: BYTE_ARRAY, UTF8, OPTIONAL' '| - Freight_ServiceLevel: BYTE_ARRAY, UTF8, OPTIONAL' '| - Freight_TransportMode: INT32, OPTIONAL' '| - Freight_FreightCharge: DOUBLE, OPTIONAL' '| - ShipmentType: BYTE_ARRAY, UTF8, OPTIONAL' '| - IsFreightForwarded: BOOLEAN, OPTIONAL' '| - LeadTrackingNumber: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipFromFacility_Code: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipFromFacility_PackingLocation: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_LocationId: INT32, OPTIONAL' '| - ShipTo_Description: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_AddressLine1: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_AddressLine2: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_AddressLine3: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_Country: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_CountryId: INT32, OPTIONAL' '| - ShipTo_Address_Id: INT32, OPTIONAL' '| - ShipTo_Address_Locality: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_PostalCode: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_CompanyId: INT32, OPTIONAL' '| - ShipTo_Address_Name: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_StateId: INT32, OPTIONAL' '| - ShipTo_Address_StateCode: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_Address_CountryCode: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipTo_FacilityCode: BYTE_ARRAY, UTF8, OPTIONAL' '| - TotalQtyShipped: DOUBLE, OPTIONAL' '| - ConsolidationMethod: INT32, OPTIONAL' '| - CompletedByUserId: INT32, OPTIONAL' '| - ShippedByUserId: INT32, OPTIONAL' '| - Status_StatusId: INT32, OPTIONAL' '| - Status_Description: BYTE_ARRAY, UTF8, OPTIONAL' '| - Status_ChangedDate: BYTE_ARRAY, UTF8, OPTIONAL' '| - PrecisionConfig_Client: BYTE_ARRAY, UTF8, OPTIONAL' '| - PrecisionConfig_Locale: BYTE_ARRAY, UTF8, OPTIONAL' '| - PrecisionConfig_PackingLocation: BYTE_ARRAY, UTF8, OPTIONAL' '| - PrecisionConfig_Language: BYTE_ARRAY, UTF8, OPTIONAL' '| - PortOfLading: BYTE_ARRAY, UTF8, OPTIONAL' '| - ShipDate: BYTE_ARRAY, UTF8, OPTIONAL' '| - ReadyToShipDate: BYTE_ARRAY, UTF8, OPTIONAL' '| - RealShipDate: BYTE_ARRAY, UTF8, OPTIONAL' '| - DispatchDate: BYTE_ARRAY, UTF8, OPTIONAL' '| - EndOfDayData_EndOfDayId: BYTE_ARRAY, UTF8, OPTIONAL' '| - EndOfDayData_EodStartedDate: BYTE_ARRAY, UTF8, OPTIONAL' '| - Billing_CustomerBilling_BillingId: INT32, OPTIONAL' '| - Billing_CustomerBilling_CustomerId: INT32, OPTIONAL' '| - Billing_CustomerBilling_Address_AddressId: INT32, OPTIONAL' '| - Billing_CustomerBilling_Address_AddressName: BYTE_ARRAY, UTF8, OPTIONAL' '| - Billing_CustomerBilling_Address_Division: BYTE_ARRAY, UTF8, OPTIONAL' '| - Billing_CustomerBilling_Address_AddressLine1: BYTE_ARRAY, UTF8, ' 'OPTIONAL' '| - Billing_CustomerBilling_Address_AddressLine2: BYTE_ARRAY, UTF8, ' 'OPTIONAL' '| - Billing_CustomerBilling_Address_AddressLine3: BYTE_ARRAY, UTF8, ' 'OPTIONAL' '| - Billing_CustomerBilling_Address_PostalCode: BYTE_ARRAY, UTF8, OPTIONAL' '| - Billing_CustomerBilling_Address_City: BYTE_ARRAY, UTF8, OPTIONAL' '| - Billing_CustomerBilling_Address_IsoCountryCode: BYTE_ARRAY, UTF8, ' 'OPTIONAL' '| - Billing_CustomerBilling_Address_StateCode: BYTE_ARRAY, UTF8, OPTIONAL' '| - Billing_CustomerBilling_IsBillTax: BOOLEAN, OPTIONAL' '| - Billing_CustomerBilling_TermId: INT32, OPTIONAL' '| - Billing_CustomerBilling_IsDistributor: BOOLEAN, OPTIONAL' '| - Billing_CustomerBilling_IsoCurrencyCode: BYTE_ARRAY, UTF8, OPTIONAL' '| - Billing_CustomerBilling_CompanyId: INT32, OPTIONAL' '| - Billing_CustomerBilling_IsSAB: BOOLEAN, OPTIONAL' '| - Billing_IsBilled: BOOLEAN, OPTIONAL' '  - ShipAttention: BYTE_ARRAY, UTF8, OPTIONAL'
            assert(expect == str(s.schema).replace("\n", ""))
            s.schema
